<TITLE>A Solution to Using MPI_Pack to share data</TITLE>
<BODY BGCOLOR="FFFFFF">
<PRE>
#include &lt;stdio.h&gt;
#include "mpi.h"

int main( argc, argv )
int argc;
char **argv;
{
    int          rank;
    int          packsize, position;
    int          a;
    double       b;
    char         packbuf[100];

    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Init.html#MPI_Init">MPI_Init</A>( &amp;argc, &amp;argv );

    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>( MPI_COMM_WORLD, &amp;rank );

    do {
	if (rank == 0) {
	    scanf( "%d %lf", &amp;a, &amp;b );
	    packsize = 0;
	    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Pack.html#MPI_Pack">MPI_Pack</A>( &amp;a, 1, MPI_INT, packbuf, 100, &amp;packsize, 
		      MPI_COMM_WORLD );
	    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Pack.html#MPI_Pack">MPI_Pack</A>( &amp;b, 1, MPI_DOUBLE, packbuf, 100, &amp;packsize, 
		      MPI_COMM_WORLD );
	}
	<A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>( &amp;packsize, 1, MPI_INT, 0, MPI_COMM_WORLD );
	<A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>( packbuf, packsize, MPI_PACKED, 0, MPI_COMM_WORLD );
	if (rank != 0) {
	    position = 0;
	    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Unpack.html#MPI_Unpack">MPI_Unpack</A>( packbuf, packsize, &amp;position, &amp;a, 1, MPI_INT, 
			MPI_COMM_WORLD );
	    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Unpack.html#MPI_Unpack">MPI_Unpack</A>( packbuf, packsize, &amp;position, &amp;b, 1, MPI_DOUBLE,
			MPI_COMM_WORLD );
	}
	
	printf( "Process %d got %d and %lf\n", rank, a, b );
    } while (a &gt;= 0);

    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Finalize.html#MPI_Finalize">MPI_Finalize</A>( );
    return 0;
}
</PRE>
</BODY>
